<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="zh"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../jacoco-resources/report.gif" type="image/gif"/><title>Layouts.java</title><link rel="stylesheet" href="../../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../../index.html" class="el_report">gturbine-maven-plugin</a> &gt; <a href="../index.html" class="el_bundle">gturbine-loader-tools</a> &gt; <a href="index.source.html" class="el_package">org.excellentcoder.gturbine.loader.tools</a> &gt; <span class="el_source">Layouts.java</span></div><h1>Layouts.java</h1><pre class="source lang-java linenums">/*
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the &quot;License&quot;); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package org.excellentcoder.gturbine.loader.tools;

import java.io.File;
import java.util.Collections;
import java.util.HashMap;
import java.util.Locale;
import java.util.Map;

/**
 * Common {@link Layout}s.
 *
 * @author Phillip Webb
 * @author Dave Syer
 * @author Andy Wilkinson
 * @since 1.0.0
 */
public final class Layouts {

<span class="nc" id="L35">    private Layouts() {</span>
<span class="nc" id="L36">    }</span>

    /**
     * Return a layout for the given source file.
     * @param file the source file
     * @return a {@link Layout}
     */
    public static Layout forFile(File file) {
<span class="nc bnc" id="L44" title="All 2 branches missed.">        if (file == null) {</span>
<span class="nc" id="L45">            throw new IllegalArgumentException(&quot;File must not be null&quot;);</span>
        }
<span class="nc" id="L47">        String lowerCaseFileName = file.getName().toLowerCase(Locale.ENGLISH);</span>
<span class="nc bnc" id="L48" title="All 2 branches missed.">        if (lowerCaseFileName.endsWith(&quot;.jar&quot;)) {</span>
<span class="nc" id="L49">            return new Jar();</span>
        }
<span class="nc bnc" id="L51" title="All 2 branches missed.">        if (lowerCaseFileName.endsWith(&quot;.war&quot;)) {</span>
<span class="nc" id="L52">            return new War();</span>
        }
<span class="nc bnc" id="L54" title="All 4 branches missed.">        if (file.isDirectory() || lowerCaseFileName.endsWith(&quot;.zip&quot;)) {</span>
<span class="nc" id="L55">            return new Expanded();</span>
        }
<span class="nc" id="L57">        throw new IllegalStateException(&quot;Unable to deduce layout for '&quot; + file + &quot;'&quot;);</span>
    }

    /**
     * Executable JAR layout.
     */
<span class="nc" id="L63">    public static class Jar implements RepackagingLayout {</span>

        @Override
        public String getLauncherClassName() {
<span class="nc" id="L67">            return &quot;org.springframework.boot.loader.JarLauncher&quot;;</span>
        }

        @Override
        public String getLibraryDestination(String libraryName, LibraryScope scope) {
<span class="nc" id="L72">            return &quot;BOOT-INF/lib/&quot;;</span>
        }

        @Override
        public String getClassesLocation() {
<span class="nc" id="L77">            return &quot;&quot;;</span>
        }

        @Override
        public String getRepackagedClassesLocation() {
<span class="nc" id="L82">            return &quot;BOOT-INF/classes/&quot;;</span>
        }

        @Override
        public boolean isExecutable() {
<span class="nc" id="L87">            return true;</span>
        }

    }

    /**
     * Executable expanded archive layout.
     */
<span class="nc" id="L95">    public static class Expanded extends Jar {</span>

        @Override
        public String getLauncherClassName() {
<span class="nc" id="L99">            return &quot;org.springframework.boot.loader.PropertiesLauncher&quot;;</span>
        }

    }

    /**
     * No layout.
     */
<span class="nc" id="L107">    public static class None extends Jar {</span>

        @Override
        public String getLauncherClassName() {
<span class="nc" id="L111">            return null;</span>
        }

        @Override
        public boolean isExecutable() {
<span class="nc" id="L116">            return false;</span>
        }

    }

    /**
     * Executable WAR layout.
     */
<span class="nc" id="L124">    public static class War implements Layout {</span>

        private static final Map&lt;LibraryScope, String&gt; SCOPE_DESTINATIONS;

        static {
<span class="nc" id="L129">            Map&lt;LibraryScope, String&gt; map = new HashMap&lt;&gt;();</span>
<span class="nc" id="L130">            map.put(LibraryScope.COMPILE, &quot;WEB-INF/lib/&quot;);</span>
<span class="nc" id="L131">            map.put(LibraryScope.CUSTOM, &quot;WEB-INF/lib/&quot;);</span>
<span class="nc" id="L132">            map.put(LibraryScope.RUNTIME, &quot;WEB-INF/lib/&quot;);</span>
<span class="nc" id="L133">            map.put(LibraryScope.PROVIDED, &quot;WEB-INF/lib-provided/&quot;);</span>
<span class="nc" id="L134">            SCOPE_DESTINATIONS = Collections.unmodifiableMap(map);</span>
<span class="nc" id="L135">        }</span>

        @Override
        public String getLauncherClassName() {
<span class="nc" id="L139">            return &quot;org.springframework.boot.loader.WarLauncher&quot;;</span>
        }

        @Override
        public String getLibraryDestination(String libraryName, LibraryScope scope) {
<span class="nc" id="L144">            return SCOPE_DESTINATIONS.get(scope);</span>
        }

        @Override
        public String getClassesLocation() {
<span class="nc" id="L149">            return &quot;WEB-INF/classes/&quot;;</span>
        }

        @Override
        public boolean isExecutable() {
<span class="nc" id="L154">            return true;</span>
        }

    }

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.7.9.201702052155</span></div></body></html>